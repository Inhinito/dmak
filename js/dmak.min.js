/*
 *  Draw Me A Kanji - v0.1.1
 *  A funny drawer for your Japanese writings
 *  http://drawmeakanji.com
 *
 *  Made by Matthieu Bilbille
 *  Under MIT License
 */
!function(){"use strict";function a(a){var b,c,d,e,f=[];for(d=0;d<a.length;d++)for(e=0;e<a[d].length;e++)b=Raphael.getTotalLength(a[d][e]),c={"char":d,length:b,duration:b*g.options.step*1e3,path:a[d][e],object:null},f.push(c);return f}function b(a){var b,c,d=[];for(c=0;a>c;c++)b=new Raphael(g.options.element,g.options.width+"px",g.options.height+"px"),b.canvas.setAttribute("class","dmak-svg"),d.push(b);return d.reverse()}function c(a){var b;for(b=0;b<a.length;b++)a[b].path("M"+g.options.width/2+",0 L"+g.options.width/2+","+g.options.height).attr(g.options.grid.attr),a[b].path("M0,"+g.options.height/2+" L"+g.options.width+","+g.options.height/2).attr(g.options.grid.attr)}function d(a,b){b.object=a.path(b.path),b.object.attr(g.options.stroke.attr),g.options.stroke.animated&&e(b)}function e(a){a.object.attr({stroke:g.options.stroke.attr.active}),a.object.node.style.transition=a.object.node.style.WebkitTransition="none",a.object.node.style.strokeDasharray=a.length+" "+a.length,a.object.node.style.strokeDashoffset=a.length,a.object.node.getBoundingClientRect(),a.object.node.style.transition=a.object.node.style.WebkitTransition="stroke-dashoffset "+a.duration+"ms ease",a.object.node.style.strokeDashoffset="0",setTimeout(function(){null!==a.object&&(a.object.node.style.stroke=g.options.stroke.attr.stroke,a.object.node.style.transition=a.object.node.style.WebkitTransition="stroke 400ms ease")},a.duration)}function f(a,b){var c,d=a;if(2!==arguments.length)throw new Error("Missing arguments in extend function");for(c in b)"object"==typeof d[c]?d[c]=f(d[c],b[c]):d.hasOwnProperty(c)&&(d[c]=b[c]);return d}var g=function(a,b){if(this.text=a,this.options=f(g.options,b),this.strokes=[],this.papers=[],this.pointer=0,this.timeouts=[],!this.options.skipLoad){var c=new DmakLoader(this.options.uri);c.load(a,function(a){this.setStrokes(a),this.options.loaded(this.strokes),this.options.autoplay&&this.render()}.bind(this))}};g.VERSION="0.1.1",g.options={uri:"",skipLoad:!1,autoplay:!0,height:109,width:109,step:.03,element:"draw",stroke:{animated:!0,attr:{active:"#F92672",stroke:"#272822","stroke-width":3,"stroke-linecap":"round","stroke-linejoin":"round"}},grid:{show:!0,attr:{stroke:"#CCCCCC","stroke-width":.5,"stroke-dasharray":"--"}},loaded:function(){},erased:function(){},drew:function(){}},g.fn=g.prototype={setStrokes:function(d){this.strokes=a(d),this.papers=b(d.length),this.options.grid.show&&c(this.papers)},erase:function(a){if(this.timeouts.length)return!1;if(this.pointer<=0)return!1;"undefined"==typeof a&&(a=0);do this.pointer--,this.strokes[this.pointer].object.remove(),this.strokes[this.pointer].object=null,this.options.erased(this.pointer);while(this.pointer>a)},render:function(a){if(this.timeouts.length)return!1;if("undefined"==typeof a)a=this.strokes.length;else if(a>this.strokes.length)return!1;var b,c,e=function(a){d(a.papers[a.strokes[a.pointer].char],a.strokes[a.pointer]),a.pointer++,a.timeouts.shift(),a.options.drew(a.pointer)},f=0;for(b=this.pointer;a>b;b++)0>=f?e(this):(c=setTimeout(e,f,this),this.timeouts.push(c)),f+=this.strokes[b].duration},pause:function(){for(var a=0;a<this.timeouts.length;a++)window.clearTimeout(this.timeouts[a]);this.timeouts=[]},eraseLastStrokes:function(a){this.erase(this.pointer-a)},renderNextStrokes:function(a){this.render(this.pointer+a)}},window.Dmak=g}(),function(){"use strict";function a(a,c,d,e){var f=new XMLHttpRequest;f.open("GET",a+"0"+d+".svg",!0),f.onreadystatechange=function(){4===f.readyState&&(200===f.status?e.done(c,b(f.response)):e.error(f.statusText))},f.send()}function b(a){var b,c=new DOMParser,d=c.parseFromString(a,"application/xml").querySelectorAll("path"),e=[];for(b=0;b<d.length;b++)e.push(d[b].getAttribute("d"));return e}var c=function(a){this.uri=a};c.prototype.load=function(b,c){var d,e=[],f=b.length,g=0,h={done:function(a,b){e[a]=b,g++,g===f&&c(e)},error:function(a){console.log("Error",a)}};for(d=0;f>d;d++)a(this.uri,d,b.charCodeAt(d).toString(16),h)},window.DmakLoader=c}();